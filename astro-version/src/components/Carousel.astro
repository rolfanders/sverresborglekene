---
// Hent bilder fra JSON
async function getImages() {
  try {
    const response = await fetch('https://grenaderkorpset.no/sverresborglekene/2025/assets/slideshow/bilder.json');
    if (!response.ok) throw new Error('Kunne ikke hente bilder');
    const data = await response.json();
    return data.images || [];
  } catch (error) {
    console.error('Feil ved henting av bilder:', error);
    return [];
  }
}

const images = await getImages();
---

<div class="carousel">
  {images.length > 0 ? (
    images.map((image, index) => (
      <img 
        src={image.url} 
        alt={image.description || 'Bilde fra Sverresborglekene'} 
        class={index === 0 ? 'active' : ''} 
      />
    ))
  ) : (
    <p>Ingen bilder Ã¥ vise.</p>
  )}
</div>

<script>
  function setupCarousel() {
    const images = document.querySelectorAll('.carousel img');
    let currentIndex = 0;

    function showNextImage() {
      images[currentIndex].classList.remove('active');
      currentIndex = (currentIndex + 1) % images.length;
      images[currentIndex].classList.add('active');
    }

    setInterval(showNextImage, 3000);
  }

  document.addEventListener('DOMContentLoaded', setupCarousel);
</script>

<style>
  .carousel {
    width: 100%;
    margin: 0 auto;
    position: relative;
    overflow: hidden;
    border-radius: 24px;
    margin-bottom: 2em;
    display: grid;
    justify-items: center;
  }

  .carousel img {
    width: 100%;
    max-width: 100%;
    height: auto;
    opacity: 0;
    visibility: hidden;
    transition: opacity 1s ease-in-out, visibility 0s linear 1s;
    grid-area: 1 / 1;
    border-radius: 24px;
  }

  .carousel img.active {
    opacity: 1;
    visibility: visible;
    transition: opacity 1s ease-in-out, visibility 0s linear 0s;
  }
</style>
